# Release Notes v1.1.0

**Release Date:** October 2025  
**Previous Release:** v1.0.0 (June 2024)

---

## ‚ö†Ô∏è Important: Storage Location Changed

**Your data will move to a new location on first run:**

- **Windows**: `%LOCALAPPDATA%\USDXFixGap\` (was: app directory)
- **Linux**: `~/.local/share/USDXFixGap/` (follows XDG standard)

**What you need to know:**
- ‚úÖ The app creates new config automatically
- ‚úÖ Old data stays in app directory (not deleted)
- ‚úÖ Optional: Manually copy `config.ini` if you want to keep settings
- ‚úÖ AI models will re-download to new location (~390 MB)

**Why this change?**
- Better multi-user support
- Update-safe storage (your data survives app updates)
- Follows OS conventions and standards

---

## üöÄ Major Features

### 1. MDX Detection Method (NEW - Now Default!)

**Complete rewrite of vocal detection engine:**
- **5-10x faster** than previous methods
- **More accurate** onset detection using Meta's Demucs AI
- **Smart chunked scanning** - processes only what's needed
- **Energy-based detection** with adaptive thresholds
- **SNR confidence scoring** - know how reliable each detection is

**Performance:**
- **GPU**: 10-30 seconds per song (with optional GPU Pack)
- **CPU**: 30-60 seconds per song
- **Previous method**: 2-3 minutes per song

**Technical improvements:**
- Uses state-of-the-art Demucs vocal separation
- Expanding window search strategy
- Stops as soon as onset found (early exit optimization)
- FP16 precision on GPU for faster inference
- CPU thread optimization (uses N-1 cores)

### 2. GPU Acceleration Support (Optional)

**Optional NVIDIA GPU support for 5-10x faster processing:**
- **GPU Pack** - downloadable CUDA runtime (~1 GB)
- **Easy installation** via GUI or CLI
- **Offline support** - install from ZIP file
- **Auto-detection** of NVIDIA hardware
- **Graceful fallback** to CPU if GPU unavailable

**Features:**
- Download from GUI: Settings ‚Üí Download GPU Pack
- CLI installation: `usdxfixgap.exe --setup-gpu`
- Offline ZIP installation supported
- Per-user installation in LOCALAPPDATA
- No admin rights required

**See:** [GPU Acceleration Guide](../gpu-acceleration.md)

### 3. Cross-Platform Storage

**Proper support for Windows and Linux:**
- Follows platform conventions (LOCALAPPDATA, XDG)
- Respects environment variables
- Portable mode fallback
- All user data in one predictable location

**New unified structure:**
```
%LOCALAPPDATA%\USDXFixGap\     (Windows)
~/.local/share/USDXFixGap/     (Linux)
‚îú‚îÄ‚îÄ config.ini                  # Configuration
‚îú‚îÄ‚îÄ cache.db                    # Song metadata cache
‚îú‚îÄ‚îÄ usdxfixgap.log              # Application logs
‚îú‚îÄ‚îÄ .tmp/                       # Temporary files
‚îú‚îÄ‚îÄ output/                     # Default output
‚îú‚îÄ‚îÄ models/                     # AI models (NEW!)
‚îÇ   ‚îú‚îÄ‚îÄ demucs/                 # Demucs models (~350 MB)
‚îÇ   ‚îî‚îÄ‚îÄ spleeter/               # Spleeter models (~40 MB)
‚îî‚îÄ‚îÄ gpu_runtime/                # GPU Pack (optional)
```

**Configurable model paths:**
```ini
[Paths]
models_directory = E:\AI_Models          # Custom drive
models_directory = \\server\shared\models # Network share
```

---

## ‚ú® New Features

### Detection & Processing
- **MDX provider** - Fast, accurate vocal onset detection (now default)
- **GPU acceleration** - Optional NVIDIA CUDA support
- **Confidence scoring** - SNR-based reliability metrics
- **Smart caching** - Reuses separated vocals for confidence computation
- **Early exit optimization** - Stops processing as soon as onset found

### User Interface
- **Song count label** - See total songs in current directory
- **Improved task list** - Individual task updates
- **Better error handling** - Clear error messages with recovery options
- **Performance optimizations** - Faster UI updates and rendering

### Configuration & Storage
- **Cross-platform paths** - Windows/Linux support with OS conventions
- **Configurable model storage** - Set custom locations for AI models
- **Unified data directory** - Everything in one place
- **Environment variable expansion** - Support for dynamic paths

### Developer Features
- **Async logging** - Non-blocking log writes for better performance
- **Worker error signals** - Proper exception payload forwarding
- **Centralized status mapping** - GapInfo as single source of truth
- **Service standardization** - Consistent patterns across codebase

---

## üêõ Bug Fixes

### Critical Fixes
- **Fixed crash on songs without intro**: Songs with vocals starting immediately no longer fail detection
  - Returns `gap=0` instead of throwing exception
  - Affects songs like "101 Dalmatiner - Cruella De Vil"
- **Fixed runtime crashes** from missing error signal connections
- **Fixed status update** after audio normalization
- **Fixed duration N/A** display issue in UI

### Detection Improvements
- Fixed onset accuracy in provider semantics
- Improved silence period detection
- Better handling of edge cases

### UI/UX Fixes
- Suppressed harmless TorchAudio MP3 warnings for cleaner console output
- Fixed worker error signal connections
- Improved error handling and user feedback

### System Fixes
- **Windows**: Fixed `CREATE_NO_WINDOW` subprocess issue
- **Caching**: Fixed storing duration in cache database
- **Import errors**: Fixed wrong import statements

---

## üîÑ Changes & Improvements

### Breaking Changes
- **Storage location changed** (see migration guide above)
- **Default detection method**: Changed from Spleeter to MDX
- **Models location**: Now in centralized app data directory

### Performance
- **5-10x faster** vocal detection with MDX
- **Optimized UI** rendering and updates
- **Async logging** for better responsiveness
- **CPU threading** optimized (uses N-1 cores)

### Architecture
- **Provider refactoring** - Cleaner separation of detection methods
- **Actions refactoring** - Better code organization
- **Service standardization** - Consistent error handling patterns
- **Signal centralization** - GapInfo as single source of truth

### Documentation
- Rewrote README for end users
- Added GPU acceleration guide
- Updated architecture documentation
- Added coding standards documentation
- Aligned docs with current implementation

---

## üóëÔ∏è Removed

- **VAD/PYIN detection methods** - Replaced by superior MDX approach
- **Old action patterns** - Replaced with standardized approach

---

## üì• Installation

### Windows
1. Download `usdxfixgap-v1.1.0-windows.zip`
2. Extract to any folder (e.g., `C:\USDXFixGap\`)
3. Run `usdxfixgap.exe`

### Linux
1. Download `usdxfixgap-v1.1.0-linux.tar.gz`
2. Extract: `tar -xzf usdxfixgap-v1.1.0-linux.tar.gz`
3. Make executable: `chmod +x usdxfixgap`
4. Run: `./usdxfixgap`

### Requirements
- **Windows**: Windows 10/11 (64-bit)
- **Linux**: Ubuntu 20.04+, Fedora, Arch, or compatible (64-bit)
- **Optional**: NVIDIA GPU with CUDA support for GPU acceleration
- **Disk Space**: ~500 MB for app + AI models

---

## üîÑ Upgrading from v1.0.0

### Quick Steps
1. Download new version
2. Extract and run
3. **(Optional)** Copy old `config.ini` to new location if you want to keep settings

### Finding Your New Data Directory

**Windows:**
- Press `Win+R`
- Type: `%LOCALAPPDATA%\USDXFixGap`
- Press Enter

**Linux:**
- Open terminal
- Run: `cd ~/.local/share/USDXFixGap && ls`

### Keeping Your Old Settings (Optional)

**If you want to preserve your configuration:**
1. Locate old `config.ini` in app directory
2. Copy to new location (see above)
3. Copy `cache.db` too to preserve song cache

### Models Will Re-Download

On first run with the new version, AI models will download to the new location (~390 MB total):
- Demucs model: ~350 MB
- Spleeter model: ~40 MB

**To avoid re-downloading:**
- Manually move models from old cache to new `models/` directory
- Old location: `~/.cache/torch/` and `~/.cache/spleeter/`
- New location: `<data_dir>/models/demucs/` and `<data_dir>/models/spleeter/`

---

## ÔøΩ What's Changed Since June 2024

### By the Numbers
- **67 commits** since v1.0.0
- **Complete detection engine rewrite** with MDX
- **5-10x performance improvement** with GPU support
- **2 new major features** (MDX, GPU acceleration)
- **15+ bug fixes** and stability improvements

### Commit Highlights

**Major Features:**
- Implement full MDX provider with Demucs (now default)
- Add GPU acceleration support with PyTorch CUDA
- Implement GPU Pack system for optional CUDA acceleration
- Add cross-platform storage (Windows/Linux)

**Improvements:**
- Optimize UI performance
- Add async logging
- Refactor actions and services
- Centralize status mapping via GapInfo
- Add configurable vocal onset detection

**Bug Fixes:**
- Fix runtime crashes and error signal connections
- Fix status update after normalize
- Fix duration N/A display
- Fix subprocess CREATE_NO_WINDOW error (Windows)
- Fix caching and import errors

**Documentation:**
- Rewrite README for end users
- Add GPU acceleration guide
- Align documentation with current implementation
- Add architecture and coding standards docs

---

## üêõ Known Issues

- **GPU Pack Windows-only** - Linux GPU support coming in future release

**Reporting Issues:**
Please report bugs on [GitHub Issues](https://github.com/vtietz/usdxfixgapgui/issues)

---

## üí¨ Questions?

### Where is my data now?
- **Windows**: `%LOCALAPPDATA%\USDXFixGap\`
- **Linux**: `~/.local/share/USDXFixGap/`

### Can I change where models are stored?
Yes! Edit `config.ini`:
```ini
[Paths]
models_directory = E:\AI_Models
```

### Do I need GPU acceleration?
No, it's optional. The app works fine on CPU:
- **With GPU**: 10-30 seconds per song
- **Without GPU (CPU)**: 30-60 seconds per song

### Why is MDX now the default?
- 5-10x faster than previous methods
- More accurate onset detection
- Better confidence scoring
- Uses state-of-the-art AI (Meta's Demucs)

### Will my old songs need to be re-processed?
No, your song cache (`cache.db`) is preserved if you copy it to the new location.

---

## üôè Thanks

Special thanks to:
- All users who provided feedback and bug reports
- Meta AI for the Demucs vocal separation model
- The PyTorch team for CUDA support
- The UltraStar community

---

## ÔøΩ Additional Resources

- [Full Changelog](../../CHANGELOG.md)
- [GPU Acceleration Guide](../gpu-acceleration.md)
- [Cross-Platform Storage Guide](../cross-platform-storage.md)
- [Architecture Documentation](../architecture.md)
- [Coding Standards](../coding-standards.md)

---

## üìù Checksums

```
SHA256:
<hash>  usdxfixgap-v1.1.0-windows.zip
<hash>  usdxfixgap-v1.1.0-linux.tar.gz
```

---

**Download links:**
- [Windows (ZIP)](https://github.com/vtietz/usdxfixgapgui/releases/download/v1.1.0/usdxfixgap-v1.1.0-windows.zip)
- [Linux (tar.gz)](https://github.com/vtietz/usdxfixgapgui/releases/download/v1.1.0/usdxfixgap-v1.1.0-linux.tar.gz)
