# v1.2.0 - Streamlined Detection & Watch Mode

**Released**: 2025-11-14

## ⚠️ Breaking Changes

- **Detection simplified**: MDX (Demucs) is now the only method - Spleeter and HQ Segment removed
- **Environment**: Migrated from Anaconda to standard Python venv (.venv)
- **Storage**: App data now in platform-standard locations (no change from v1.1.0)

## What's New

### Watch Mode - Real-Time Monitoring
- New: Auto-discover songs as you add them to watched folder
- New: Smart file monitoring using OS-native watchers (efficient, low CPU)
- New: Configurable debouncing prevents processing storms
- New: Cache synchronization keeps UI in sync with filesystem changes

### UI Improvements
- New: Resizable panels with drag splitters (song list, waveform, task/log views)
- New: Smart startup dialog with auto-checked "Don't show again" when system configured
- New: Dynamic waveform markers overlay (playhead and gap positions)
- New: Viewport lazy loading for smoother scrolling with large song lists
- New: Window persistence saves size, position, and panel layouts between sessions

### GPU Pack Enhancements
- New: Activation option when existing pack detected (no forced re-download)
- Fix: Restart loop after GPU activation (startup dialog no longer reappears post opt-in)
- Fix: Stability from safe CPU fallback (avoid torch re-import conflicts)
- Change: GPU bootstrap loads pack paths early with graceful fallback if torch preloaded

### Multi-Song Tracking
- New: Multi-entry gap info tracks gap data per song independently in shared folders
- New: No cross-contamination between songs sharing the same folder

### Developer & Quality
- New: 631 cross-platform tests with automated CI/CD
- Chore: Code complexity reduced in config, UI, and build scripts
- Chore: GPU utilities consolidated into modular package structure
- Chore: Fixed 56 type errors for better IDE support
- Chore: Improved code analysis reporting with complexity and style metrics
- Chore: Consolidated dependency management (requirements-base.txt + requirements-gpu.txt)
- Chore: GitHub Actions automated builds for Windows/Linux/macOS

### Bug Fixes
- Fix: Windows "Access Denied" errors during audio normalization (improved file locking)
- Fix: config.ini reset during tests
- Fix: Waveform amplitude inaccuracy (removed audio filter to preserve original signal)
- Fix: Cache versioning now prompts user on upgrade to confirm re-scan
- Fix: MDX gap detection for late expected gaps (distance-based band gating)
- Fix: UI freezes during gap detection (media player unload before processing)
- Fix: Gap marker positioning and duration calculation accuracy
- Fix: GPU Pack .zip cleanup after successful extraction
- Fix: Worker queue cancellation and cleanup
- Fix: Task queue viewer crashes when canceling tasks (complete rewrite with simple rebuild pattern)
- Fix: Waveform missing notes overlay on song selection (async race condition resolved)

## FAQs

**What happened to Spleeter detection?**
Removed to support modern Python versions (3.12+). MDX (Demucs) provides better accuracy and performance.

**Where is my data stored?**
Platform-standard locations since v1.1.0: `%LOCALAPPDATA%\USDXFixGap\` (Windows), `~/.local/share/USDXFixGap/` (Linux), `~/Library/Application Support/USDXFixGap/` (macOS)

**What's Watch Mode?**
Enable in UI to automatically scan for new songs, update changed files, and keep your collection synchronized.

## 🙏 Thanks

Thanks to all contributors, testers, and users for valuable feedback that made this release possible!
