# v1.2.0 - Streamlined Detection & Watch Mode

## ⚠️ Breaking Changes

- **Detection simplified**: MDX (Demucs) is now the only method - Spleeter and HQ Segment removed
- **Environment**: Migrated from Anaconda to standard Python venv (.venv)
- **Storage**: App data now in platform-standard locations (see v1.1.0 notes - no change from v1.1.0)

## ✨ What's New

### Watch Mode - Real-Time Monitoring
- **Auto-discover new songs** as you add them to watched folder
- **Smart file monitoring** using OS-native watchers (efficient, low CPU)
- **Configurable debouncing** (500ms default) prevents processing storms
- **Cache synchronization** keeps UI in sync with filesystem changes

### Multi-Song Tracking
- **Multi-entry gap info**: Folders with multiple txt files now track gap data per song independently
- **No cross-contamination** between songs sharing a folder

### UI Improvements
- **Waveform markers**: Dynamic overlay markers (playhead, gaps) instead of static images
- **Viewport lazy loading**: Smoother scrolling with large song lists
- **Window persistence**: Size and position saved between sessions
- **Better layout**: Action buttons repositioned for clearer workflow

### Developer & Quality
- **516 cross-platform tests** with automated CI/CD
- **Type safety**: Fixed 56 type errors for better IDE support
- **GitHub Actions**: Automated builds for Windows/Linux/macOS
- **Code cleanup**: Removed feature flags, unified code paths, improved architecture
- **GPU Pack in PyInstaller builds**: Fixed CUDA detection in built executables via runtime hooks

## 🐛 Key Fixes

- **Audio normalization**: Fixed Windows "Access Denied" errors with improved file locking
- **Config persistence**: Fixed config.ini reset during tests
- **Waveform accuracy**: Removed audio filter to preserve original amplitude
- **Cache versioning**: User prompt on upgrade to confirm re-scan
- **GPU Pack**: Improved compatibility and error handling
- **Worker queue**: Better cancellation and cleanup

## 📥 Installation

### Windows
Download `usdxfixgap-v1.2.0-windows.exe` and run.

**Note**: Windows Defender may show a false positive warning (common with PyInstaller apps). The source code is open for inspection.

### Linux
```bash
tar -xzf usdxfixgap-v1.2.0-linux.tar.gz
./usdxfixgap
```

### macOS
```bash
tar -xzf usdxfixgap-v1.2.0-macos.tar.gz
./usdxfixgap
```

## 🔄 Upgrading from v1.1.0

**No migration needed** - your data directory location hasn't changed since v1.1.0.

**Data location reminder:**
- **Windows**: `%LOCALAPPDATA%\USDXFixGap\`
- **Linux**: `~/.local/share/USDXFixGap/`
- **macOS**: `~/Library/Application Support/USDXFixGap/`

**From source:**
```bash
# Windows
.\run.bat install

# Linux/macOS
./run.sh install
```

## 🎯 What's Watch Mode?

Enable it in the UI to automatically:
- Scan for new songs when they're added
- Update songs when files change
- Keep your song list synchronized
- Process new songs automatically (if auto-detect enabled)

Perfect for actively managing your song collection!

## 🙏 Thanks

Thanks to all contributors, testers, and users for valuable feedback!
